/*  jUri v0.1
    Mini-javascript library for handling url functions
    jUri by Enric Florit is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License.
    You can read the license at http://creativecommons.org/licenses/by-sa/3.0/
    
    Email me:
    efz1005[at]gmail[dot]com */

var jUri=function(){this.setScroll=function(){if(!document.body){return setTimeout("jUri.setScroll()",1)}var a=0,b=document;if(typeof window.pageYOffset=="number"){var a=window.pageYOffset}else if(b.body.scrollTop){var a=b.body.scrollTop}else if(b.documentElement.scrollTop){var a=b.documentElement.scrollTop}jUri.prevScroll=jUri.scroll||0;jUri.scroll=a;window.onscroll=function(){jUri.setScroll()}};this.setScroll();if(!window.console){var a=window.opera?window.opera.postError:alert;window.console={log:function(b){a(b)}}}},hashChangeEvent=function(a,b){this.old=a||"#";this.new=b||"#";this.newLoc=window.location};jUri.prototype={host:window.location.host,hostname:window.location.hostname,href:window.location.href,pathname:window.location.pathname,port:window.location.port,protocol:window.location.protocol.replace(/:$/,""),get:window.location.search,fn:{checkhash:function(a,b,c){if(jUri.hash()!=a){c(new hashChangeEvent(a,jUri.hash(),b));var b=0;if(typeof window.pageYOffset=="number"){scroll=window.pageYOffset}else if(document.body.scrollTop){scroll=document.body.scrollTop}else if(document.documentElement.scrollTop){scroll=document.documentElement.scrollTop}}setTimeout('jUri.fn.checkhash("'+jUri.hash()+'", '+b+", "+c+")",1)},pageScroll:function(a){if(!document.body){return setTimeout("jUri.fn.pageScroll("+a+")",1)}jUri.fx.scroller.scrollTo(a)},getAnchor:function(a){if(!document.body){return setTimeout("jUri.fn.getAnchor("+a+")",1)}if(!a){return null}if(a.match(/^#/))a=a.replace(/^#/,"");var b=document.getElementsByTagName("a");for(var c in b){element=b[c];if(element.name.replace(/^#/,"")===a){return element}}return null},gotoAnchor:function(a){var b=jUri.fn.getAnchor(a),c=0;if(b&&b.offsetParent){do{c+=b.offsetTop}while(b=b.offsetParent)}jUri.fn.pageScroll(c)}},fx:{scroller:{stepIncrement:25,stepDelay:5,limit:6e3,running:false,nextStep:null,killTimeout:null,finalPoint:null,scrollStep:function(a,b,c){var d=jUri.fx.scroller.stepIncrement,e=jUri.fx.scroller.running;if(!e||c&&a>=b||!c&&a<=b){jUri.fx.scroller.killScroll();return}if(c&&a>=b-2*d||!c&&a<=b-2*d){d=d*.55}window.scrollTo(0,a);jUri.fx.scroller.nextStep=jUri.fx.scroller.callNext(+a+d,b,c);jUri.fx.scroller.stepIncrement=d;window.setTimeout(jUri.fx.scroller.nextStep,jUri.fx.scroller.stepDelay)},callNext:function(a,b,c){return function(){jUri.fx.scroller.scrollStep(a,b,c)}},scrollTo:function(a){jUri.fx.scroller.running=true;jUri.fx.scroller.finalPoint=a;var b=document.all?document.body.scrollTop:window.pageYOffset,c=true,d=jUri.fx.scroller.stepIncrement;if(b>a){d*=-1;c=false}jUri.fx.scroller.killTimeout=window.setTimeout(jUri.fx.scroller.killScroll,jUri.fx.scroller.limit);jUri.fx.scroller.stepIncrement=d;jUri.fx.scroller.scrollStep(b+d,a,c)},killScroll:function(){window.clearTimeout(jUri.fx.scroller.killTimeout);jUri.fx.scroller.running=false;jUri.fx.scroller.stepIncrement=50;window.scrollTo(0,jUri.fx.scroller.finalPoint);jUri.fx.scroller.finalPoint=null}}},hash:function(a,b){if(a&&a instanceof RegExp){if(window.location.hash.replace(/^#/,"").match(a)){b?b():false;return true}else{return false}}else if(a){window.location.hash=a;return a}else{return window.location.hash.replace(/^#/,"")}},hashchange:function(a){if(!document.body){return setTimeout("jUri.hashchange("+a+")",1)}var b=0;if(typeof window.pageYOffset=="number"){b=window.pageYOffset}else if(document.body.scrollTop){b=document.body.scrollTop}else if(document.documentElement.scrollTop){b=document.documentElement.scrollTop}jUri.fn.checkhash(jUri.hash(),b,a)},isHTTP:function(a){if(this.protocol.match(/^http$/)){a?a():false;return true}else{return false}},isHTTPS:function(a){if(this.protocol.match(/^https$/)){a?a():false;return true}else{return false}},vars:function(a){var b=this.get.replace(/^\?/,""),c=b.split("&"),d={};for(var e in c){var f=c[e].split("=");d[f[0]]=f[1]}if(a&&d[a])return d[a];return d},parseAsGet:function(a){var b=(a+"").replace(/^(.*?)\?/,"").split("&"),c={};for(var d in b){var e=b[d].split("=");c[e[0]]=e[1]}return c},redirect:function(a,b){if(b&&b%1===0){setTimeout("window.location.href='"+a+"'",b)}else{window.location.href=a}},reload:function(a){if(a&&a%1===0){setTimeout("window.location.reload(true);",a)}else{window.location.reload(true)}},isFile:function(a){if(this.pathname.match(/\.(html|htm|php|phtml|asp|shtml|cgi|jsp|pl)$/i)){a?a():false;return true}else{return false}},anchorExists:function(a){var b=this.fn.getAnchor(a);if(b){return true}return false},animateAnchorLinks:function(a){if(!document.body){return setTimeout('jUri.animateAnchorLinks("'+a+'")',1)}var b=[],c=[],d=document.getElementsByTagName("a");if(!a||typeof a=="undefined"||a==="undefined"){for(var e in d){if(d[e].name&&d[e].name!=""){b.push(d[e].name)}}}else{var f=a.replace(/\s/gim,"").split(","),g;for(var e in f){g=f[e];b.push(jUri.fn.getAnchor(g).name)}}for(var h in b){for(var e in d){if(d[e].href&&d[e].href!=""&&d[e].href.match("#"+b[h]+"$")){c.push(d[e])}}}for(var h in c){c[h].onclick=function(a){a.preventDefault();var b=this.href.split("#")[1];jUri.fn.gotoAnchor(b)}}},encode:function(a){return encodeURIComponent(a)},log:function(a){console.log(a)},debug:function(a){console.debug(a)},warn:function(a){console.warn(a)},error:function(a){console.error(a)}};window.jUri=new jUri
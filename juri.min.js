/*  jUri v0.1
    Mini-javascript library for handling url functions
    jUri by Enric Florit is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License.
    You can read the license at http://creativecommons.org/licenses/by-sa/3.0/
    
    Email me:
    efz1005[at]gmail[dot]com */

var jUri=function(a,b){if(!a.console){var c=a.opera?a.opera.postError:alert;a.console={log:function(a){c(a)}};a.console.error=a.console.warn=a.console.debug=a.console.log}return{host:a.location.host,hostname:a.location.hostname,href:a.location.href,pathname:a.location.pathname,port:a.location.port,protocol:a.location.protocol.replace(/:$/,""),get:a.location.search,fn:{checkhash:function(c,d,e){if(jUri.hash()!=c){e(new hashChangeEvent(c,jUri.hash(),d));var d=0;if(typeof a.pageYOffset=="number"){scroll=a.pageYOffset}else if(b.body.scrollTop){scroll=b.body.scrollTop}else if(b.documentElement.scrollTop){scroll=b.documentElement.scrollTop}}setTimeout('jUri.fn.checkhash("'+jUri.hash()+'", '+d+", "+e+")",1)},pageScroll:function(a,c){if(!b.body){return setTimeout("jUri.fn.pageScroll("+a+")",1)}jUri.fx.scroller.scrollTo(a,c)},getAnchor:function(a){if(!b.body){return setTimeout("jUri.fn.getAnchor("+a+")",1)}if(!a){return null}if(a.match(/^#/))a=a.replace(/^#/,"");var c=b.getElementsByTagName("a");for(var d in c){element=c[d];if(element.name.replace(/^#/,"")===a){return element}}return null},gotoAnchor:function(a,b){var c=jUri.fn.getAnchor(a),d=0;if(c&&c.offsetParent){do{d+=c.offsetTop}while(c=c.offsetParent)}jUri.fn.pageScroll(d,b)}},fx:{scroller:{stepIncrement:5,stepDelay:5,limit:6e3,running:false,nextStep:null,killTimeout:null,finalPoint:null,callback:null,scrollStep:function(b,c,d){var e=jUri.fx.scroller.stepIncrement,f=jUri.fx.scroller.running;if(!f||d&&b>=c||!d&&b<=c){jUri.fx.scroller.killScroll();return}if(d&&b>=c-2*e||!d&&b<=c-2*e){e=e*.55}a.scrollTo(0,b);jUri.fx.scroller.nextStep=jUri.fx.scroller.callNext(+b+e,c,d);jUri.fx.scroller.stepIncrement=e;a.setTimeout(jUri.fx.scroller.nextStep,jUri.fx.scroller.stepDelay)},callNext:function(a,b,c){return function(){jUri.fx.scroller.scrollStep(a,b,c)}},scrollTo:function(c,d){jUri.fx.scroller.running=true;jUri.fx.scroller.callback=d;jUri.fx.scroller.finalPoint=c;var e=b.all?b.body.scrollTop:a.pageYOffset,f=true,g=jUri.fx.scroller.stepIncrement;if(e>c){g*=-1;f=false}jUri.fx.scroller.killTimeout=a.setTimeout(jUri.fx.scroller.killScroll,jUri.fx.scroller.limit);jUri.fx.scroller.stepIncrement=g;jUri.fx.scroller.scrollStep(e+g,c,f)},killScroll:function(){a.clearTimeout(jUri.fx.scroller.killTimeout);jUri.fx.scroller.running=false;jUri.fx.scroller.stepIncrement=5;a.scrollTo(0,jUri.fx.scroller.finalPoint);jUri.fx.scroller.finalPoint=null;jUri.fx.scroller.callback();jUri.fx.scroller.callback=null}}},hash:function(b,c){if(b&&b instanceof RegExp){if(a.location.hash.replace(/^#/,"").match(b)){c?c():false;return true}else{return false}}else if(b){a.location.hash=b;return b}else{return a.location.hash.replace(/^#/,"")}},hashchange:function(c){if(!b.body){return setTimeout("jUri.hashchange("+c+")",1)}var d=0;if(typeof a.pageYOffset=="number"){d=a.pageYOffset}else if(b.body.scrollTop){d=b.body.scrollTop}else if(b.documentElement.scrollTop){d=b.documentElement.scrollTop}jUri.fn.checkhash(jUri.hash(),d,c)},isHTTP:function(a){if(this.protocol.match(/^http$/)){a?a():false;return true}else{return false}},isHTTPS:function(a){if(this.protocol.match(/^https$/)){a?a():false;return true}else{return false}},vars:function(a){var b=this.get.replace(/^\?/,""),c=b.split("&"),d={};for(var e in c){var f=c[e].split("=");d[f[0]]=f[1]}if(a&&d[a])return d[a];return d},parseAsGet:function(a){var b=(a+"").replace(/^(.*?)\?/,"").split("&"),c={};for(var d in b){var e=b[d].split("=");c[e[0]]=e[1]}return c},redirect:function(b,c){if(c&&c%1===0){setTimeout("window.location.href='"+b+"'",c)}else{a.location.href=b}},reload:function(b){if(b&&b%1===0){setTimeout("window.location.reload(true);",b)}else{a.location.reload(true)}},isFile:function(a){if(this.pathname.match(/\.(html|htm|php|phtml|asp|shtml|cgi|jsp|pl)$/i)){a?a():false;return true}else{return false}},anchorExists:function(a){var b=this.fn.getAnchor(a);if(b){return true}return false},animateAnchorLinks:function(a,c){if(!b.body){return setTimeout('jUri.animateAnchorLinks("'+a+'")',1)}if(!c||typeof c!="bool"){c=true}var d=[],e=[],f=b.getElementsByTagName("a");if(!a||typeof a=="undefined"||a==="undefined"){for(var g in f){if(f[g].name&&f[g].name!=""){d.push(f[g].name)}}}else{var h=a.replace(/\s/gim,"").split(","),i;for(var g in h){i=h[g];d.push(jUri.fn.getAnchor(i).name)}}for(var j in d){for(var g in f){if(f[g].href&&f[g].href!=""&&f[g].href.match("#"+d[j]+"$")){e.push(f[g])}}}for(var j in e){e[j].onclick=function(a){a.preventDefault();var b=this.href.split("#")[1];jUri.fn.gotoAnchor(b,function(){if(c)jUri.hash(b)})}}},encode:function(a){return encodeURIComponent(a)},log:function(a){console.log(a)},debug:function(a){console.debug(a)},warn:function(a){console.warn(a)},error:function(a){console.error(a)}}}(window,document),hashChangeEvent=function(a,b){this.oldHash=a||"#";this.newHash=b||"#";this.newLoc=window.location};window.jUri=jUri